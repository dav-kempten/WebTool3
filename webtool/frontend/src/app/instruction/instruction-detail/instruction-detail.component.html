<ng-container *ngIf="instructionGroup$ | async as instructionGroup else loading">

  <h1>Instruction {{instructionGroup.get('reference').value}}</h1>

  <p>InstructionGroup:<br/>{{instructionGroup.value | json}}</p>
  <p>TopicGroup:<br/>{{(topicGroup$ | async)?.value | json}}</p>
  <p>CategoryGroup:<br />{{(categoryGroup$ | async)?.value | json}}</p>
  <p>EventIds: {{instructionGroup.get('instructionId').value}},
    {{instructionGroup.get('meetingIds').value.join(', ')}}</p>
  <p>EventArray:<br/>{{(eventArray$ | async)?.value | json}}</p>


  <div [formGroup]="instructionGroup">
    <!--GuideComponent // TeamComponent // Abrechnung-->
    <div class="p-grid">
      <div class="p-col-12 p-sm-6 p-md-6 p-lg-6">
        <avk-guide
            formControlName="guideId"
            id="g1"
            label="Trainer"
            [readOnly]="!(userValState >= 0)"
            required
        ></avk-guide>
        <!--[nameIdList]="instructionGroup.get('teamIds').value"-->
      </div>
      <div class="p-col-12 p-sm-3 p-md-3 p-lg-3">
        <input id="costs" placeholder="Kosten" type="text" style='width:100%'
               pInputText>
      </div>
      <div class="p-col-12 p-sm-3 p-md-3 p-lg-3">
        <input id="revenue" placeholder="Einnahmen" type="text" style='width:100%'
               [readOnly]="!(userValState >= 0)" pInputText>
      </div>
    </div>

    <div class="p-grid">
      <div class="p-sm-6 p-md-6 p-lg-6">
        <avk-team
            formControlName="teamIds"
            id="g2"
            label="Team"
            [readOnly]="!(userValState >= 0)"
        ></avk-team>
        <!--[nameId]="instructionGroup.get('guideId').value"-->
      </div>
      <div class="p-sm-3 p-md-3 p-lg-3">
        <p-checkbox
            [formControl]="instructionGroup.controls['lowEmissionAdventure']"
            label="LEA"
            binary="true"
        ></p-checkbox>
      </div>
      <div class="p-sm-3 p-md-3 p-lg-3">
        <p-checkbox
            [formControl]="instructionGroup.controls['ladiesOnly']"
            label="LadiesOnly"
            binary="true"
        ></p-checkbox>
      </div>
    </div>

    <!--Buchungscode, Status, Kurskonzept, InfoBox-->
    <div class="p-grid">
      <div class="p-col-12 p-sm-3 p-md-3 p-lg-3">
        <input formControlName="reference" id="reference" placeholder="Buchungsnummer" type="text" style='width:100%'
               readonly pInputText>
      </div>
      <div class="p-col-12 p-sm-3 p-md-3 p-lg-3">
        <avk-dropdown formControlName="stateId" id="stateId" [readOnly]="!(userValState >= 0)"></avk-dropdown>
      </div>
      <div class="p-col-12 p-sm-3 p-md-3 p-lg-3">
        <avk-categoryselect
            formControlName="topicId"
            id="topicId"
            [readOnly]="!(userValState >= 0)">
        </avk-categoryselect>
      </div>
      <div class="p-col-12 p-sm-3 p-md-3 p-lg-3">
        <p-checkbox
            [formControl]="instructionGroup.controls['isSpecial']"
            label="Spezialkategorie"
            binary="true"
        ></p-checkbox>
      </div>
    </div>

    <!--Beschreibung-->
    <!--  <div class="p-grid">-->
    <!--    <div class="p-col-12 p-sm-12 p-md-12 p-lg-12">-->
    <!--      <textarea-->
    <!--          formControlName="description"-->
    <!--          [rows]="5"-->
    <!--          pInputTextarea-->
    <!--          placeholder="Beschreibung"-->
    <!--          autoResize="autoResize"-->
    <!--          style='width:100%'-->
    <!--      ></textarea>-->
    <!--    </div>-->
    <!--  </div>-->

    <!--Zusatzausrüstung, Besondere Vorausssetzungen-->
    <div class="p-grid">
      <div class="p-col-12 p-sm-6 p-md-6 p-lg-6">
        <avk-multiselect
            formControlName="equipmentIds"
            choice="equipment"
            label="Ausrüstung"
            [readOnly]="!(userValState >= 0)"
        ></avk-multiselect>
      </div>
      <div class="p-col-12 p-sm-6 p-md-6 p-lg-6">
        <avk-multiselect
            formControlName="qualificationIds"
            choice="requirement"
            label="Vorraussetzungen"
            [readOnly]="!(userValState >= 0)"
        ></avk-multiselect>
      </div>
    </div>

    <!--Teilnehmeranzahl, Strecke, Materialservice-->
    <div class="p-grid">
      <div class="p-col-12 p-sm-3 p-md-3 p-lg-3">
        <avk-membernumber
            formControlName="minQuantity"
            label="MinMember"
            id="m1"
            [maxMember]="instructionGroup.get('maxQuantity').value"
            [readOnly]="!(userValState >= 0)"
        ></avk-membernumber>
      </div>
      <div class="p-col-12 p-sm-3 p-md-3 p-lg-3">
        <avk-membernumber
            formControlName="maxQuantity"
            label="MaxMember"
            id="m2"
            [minMember]="instructionGroup.get('minQuantity').value"
            [readOnly]="!(userValState >= 0)"
        ></avk-membernumber>
      </div>
      <div class="p-col-12 p-sm-3 p-md-3 p-lg-3" *ngIf="false">
        <input formControlName="distance" id="distance" placeholder="PKW Strecke" type="text" style='width:100%'
               pInputText>
      </div>
      <div class="p-col-12 p-sm-3 p-md-3 p-lg-3">
        <p-checkbox
            [formControl]="instructionGroup.controls['equipmentService']"
            label="Materialservice"
            binary="true"
        ></p-checkbox>
      </div>
    </div>


    <!--Liste mit Parametern (Tabelle)-->
    <div class="p-grid">
      <div class="p-col-12 p-sm-12 p-md-12 p-lg-12">
        <p-table *ngIf="!currentEventGroup" [value]="(eventArray$|async).value" selectionMode="single"
                 (selectionChange)="selectEvent($event)">
          <ng-template pTemplate="header">
            <tr>
              <th>Datum</th>
              <th>Uhrzeit</th>
              <th>Beschreibung</th>
            </tr>
          </ng-template>
          <ng-template pTemplate="body" let-event let-i="rowIndex">
            <tr [pSelectableRow]="i">
              <td>{{event.startDate}}</td>
              <td>{{event.startTime}}</td>
              <td>{{event.name}}</td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </div>


<!--    <ng-container *ngIf="currentEventGroup">-->
<!--      <p>Edit this Event:<br/>{{currentEventGroup.value | json}}</p>-->
<!--      <form [formGroup]="currentEventGroup">-->
<!--        <label for="title">Kurztitel:</label>-->
<!--        <input id="title" formControlName="title"><br/>-->
<!--        <label for="name">Langtitel:</label>-->
<!--        <input id="name" formControlName="name"><br/>-->
<!--        <label for="description">Beschreibung:</label>-->
<!--        <input id="description" formControlName="description">-->
<!--      </form>-->
<!--      <p-button label="Zurück" (onClick)="closeDialog($event)"></p-button>-->
<!--    </ng-container>-->

    <ng-container *ngIf="currentEventGroup">
    <p-dialog header="EventDetail" [(visible)]="display">
      <form [formGroup]="currentEventGroup">
        <!--Kurztitel, Langtitel-->
        <div class="p-grid">
          <div class="p-col-12 p-sm-4 p-md-4 p-lg-4">
            <input formControlName="title" id="title" placeholder="Kurztitel" type="text" style='width:100%'
                   pInputText>
          </div>
          <div class="p-col-12 p-sm-8 p-md-8 p-lg-8">
            <input formControlName="name" id="name" placeholder="Langtitel" type="text" style='width:100%'
                   pInputText>
          </div>
        </div>

        <!--Zeitpunkt Event-->
        <div class="p-grid">
          <div class="p-col-12 p-sm-6 p-md-6 p-lg-6">
            <avk-approxdropdown formControlName="approximateId" id="approx" [readOnly]="!(userValState >= 0)"
                                [disable]="currentEventGroup.get('startTime').value"></avk-approxdropdown>

          </div>
          <div class="p-col-12 p-sm-6 p-md-6 p-lg-6">
            <avk-time formControlName="startTime" id="time" [disable]="currentEventGroup.get('approximateId').value"
            ></avk-time>
          </div>
        </div>

        <!--Zusatz: Datumseingabe (Anfang + Ende + Art)-->
        <div class="p-grid">
          <div class="p-col-12 p-sm-3 p-md-3 p-lg-3">
            <avk-date formControlName="startDate"
                      id="dbeginn" label="Start"
                      [maxInclude]="true"
            ></avk-date>
<!--                      [max]="instructionGroup.get('endDate').value"-->
          </div>
          <div class="p-col-12 p-sm-3 p-md-3 p-lg-3">
            <avk-date formControlName="endDate"
                      id="dend" label="Ende"
                      [minInclude]="true"
            ></avk-date>
<!--                      [min]="instructionGroup.get('startDate').value"-->
          </div>
          <div class="p-col-12 p-sm-3 p-md-2 p-lg-2">
            <input formControlName="description" id="description" placeholder="Art (z.B Besprechung)" type="text"
                   style="width:100%"
                   pInputText>
          </div>
          <div class="p-col-12 p-sm-3 p-md-2 p-lg-2">
            <input formControlName="location" id="location" placeholder="Ort (z.B Swoboda Alpin, Gipfel)"
                   type="text" style="width:100%"
                   pInputText>
          </div>
        </div>
      </form>
<!--</div>-->
    </p-dialog>
    </ng-container>

    <!--Teilnehmergebühr-->
    <div class="p-grid">
      <div class="p-col-12 p-sm-3 p-md-3 p-lg-3">
        <input formControlName="admission" id="admission" placeholder="Teilnehmergebühr" type="text" style='width:100%'
               pInputText>
      </div>
    </div>

    <!--Bemerkung-->
    <div class="p-grid">
      <div class="p-col-12 p-sm-12 p-md-12 p-lg-12">
      <textarea
          [rows]="3"
          pInputTextarea
          placeholder="Bemerkungen"
          autoResize="autoResize"
          style='width:100%'
      ></textarea>
      </div>
    </div>
  </div>

</ng-container>
<ng-template #loading>Bitte kurz warten!</ng-template>
